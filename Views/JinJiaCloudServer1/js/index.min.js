$(function(){console.log(getUnixTime(getNowFormatDate(1)));getCharts();getZheCharts();getOperatorLogs()});function getNewAddResource(){$.ajax({type:'get',url:'/managed/control/sendMessage.php',data:"&phone_no="+telePhoneValue,cache:false,success:function(data){if(data==1){new invokeSettime("#getSmsInfoBtnId")}else{$("#errorMsg").html(data);$('#myModal').modal('show')}}})}function getResources(){$.ajax({type:'get',url:'/managed/control/sendMessage.php',data:"&phone_no="+telePhoneValue,cache:false,timeout:5000,success:function(data){console.log(data);$("#storageId").html(``)}})}function getOperatorLogs(){$.ajax({type:'get',url:'http://localhost:8099/api/JinJiaApi/OperateLog',data:null,cache:false,timeout:5000,success:function(data){console.log(data);var resultData=JSON.parse(data.HttpData);console.log(resultData);result=resultData.data.logs;console.log(result);for(var i=0;i<result.length;i+=1){console.log(result[i].start_time);$("#operatorLogId").append(`<li>
						<div class="content-list">
							<div class="content-list-left">
								<div class="list-header">${result[i].start_time }</div>
								<div class="list-desc">${result[i].operation }</div>
							</div>`);if(result[i].result=="Success"){$("#operatorLogId").append(`<div class="content-list-right">
								<div class="list-user">${result[i].operator_name }</div>
								<div class="list-result color-success">成功</div>
							</div>
						</div>
					</li>`)}else{$("#operatorLogId").append(`<div class="content-list-right">
								<div class="list-user">${result[i].operator_name }</div>
								<div class="list-result color-fail">失败</div>
							</div>
						</div>
					</li>`)}}}})}function getNetworkFlux(){var nowTime=getUnixTime(getNowFormatDate(1));var lastTime=getUnixTime(getNowFormatDate(13));var inUrl="http://172.19.10.199:8080/v1/info/historydata?endpoint=54a21981-28e3-4da8-8ced-ec5f54ac7ecd&startTime="+nowTime+"&endTime="+lastTime+"&counter=switch.if.In/ifIndex=1,ifName=GigabitEthernet1/0/1";var outUrl="http://172.19.10.199:8080/v1/info/historydata?endpoint=54a21981-28e3-4da8-8ced-ec5f54ac7ecd&startTime="+nowTime+"&endTime="+lastTime+"&counter=switch.if.Out/ifIndex=1,ifName=GigabitEthernet1/0/1";var indata,outdata;$.ajax({type:'get',url:inUrl,data:null,timeout:5000,cache:false,dataType:"jsonp",success:function(data){console.log(data);indata=data}});$.ajax({type:'get',url:outUrl,data:null,timeout:5000,cache:false,dataType:"jsonp",success:function(data){console.log(data);outdata=data}})}function getCharts(){var myChart1=echarts.init(document.getElementById("cpuRateCharts"));var myChart2=echarts.init(document.getElementById("cpuRateCharts2"));var myChart3=echarts.init(document.getElementById("cpuRateCharts3"));var option1={title:{show:false},tooltip:{trigger:'item',formatter:"{a} <br/>{b}:({d}%)"},series:[{name:'性别',type:'pie',radius:['0%','52%'],color:new echarts.graphic.RadialGradient(0.5,0.5,0.5,[{offset:0,color:'rgba(25, 193, 213, 1)'},{offset:0.9,color:'rgba(1, 83, 138, 1)'}],false),hoverAnimation:false,label:{normal:{show:true,position:'center',color:'#FFF600',fontSize:70,fontFamily:'Digital-7 Mono'}},labelLine:{normal:{show:false}},data:[{value:55,name:'3%'}]},{name:'',type:'pie',radius:['52%','68%'],color:['rgba(1, 53, 96,.5)'],hoverAnimation:false,data:[{value:0,name:''}]},{name:'年龄结构',type:'pie',radius:['66%','82%'],color:new echarts.graphic.LinearGradient(0,0,0,1,[{offset:0,color:'rgba(25, 193, 213, 1)'},{offset:0.8,color:'rgba(9, 113, 184, 1)'}],false),hoverAnimation:false,label:{normal:{show:false}},labelLine:{normal:{show:false}},data:[{value:6,name:''}]}]};var option2={title:{show:false},tooltip:{trigger:'item',formatter:"{a} <br/>{b}:({d}%)"},series:[{name:'性别',type:'pie',radius:['0%','50%'],color:new echarts.graphic.RadialGradient(0.5,0.5,0.5,[{offset:0,color:'rgba(25, 193, 213, 1)'},{offset:0.8,color:'rgba(9, 113, 184, 1)'}],false),hoverAnimation:false,label:{normal:{show:true,position:'center',color:'#FFF600',fontSize:70,fontFamily:'Digital-7 Mono'}},labelLine:{normal:{show:false}},data:[{value:55,name:'24%'}]},{name:'',type:'pie',radius:['51%','68%'],color:['rgba(1, 53, 96,.5)'],hoverAnimation:false},{name:'年龄结构',type:'pie',radius:['66%','82%'],color:new echarts.graphic.LinearGradient(0,0,0,1,[{offset:0,color:'rgba(25, 193, 213, 1)'},{offset:0.8,color:'rgba(9, 113, 184, 1)'}],false),hoverAnimation:false,label:{normal:{show:false}},labelLine:{normal:{show:false}},data:[{value:6,name:''}]}]};var option3={title:{show:false},tooltip:{trigger:'item',formatter:"{a} <br/>{b}:({d}%)"},series:[{name:'性别',type:'pie',radius:['0%','52%'],color:new echarts.graphic.RadialGradient(0.5,0.5,0.5,[{offset:0,color:'rgba(25, 193, 213, 1)'},{offset:0.9,color:'rgba(1, 83, 138, 1)'}],false),hoverAnimation:false,label:{normal:{show:true,position:'center',color:'#FFF600',fontSize:70,fontFamily:'Digital-7 Mono'}},labelLine:{normal:{show:false}},data:[{value:55,name:'1%'}]},{name:'',type:'pie',radius:['52%','68%'],color:['rgba(1, 53, 96,.5)'],hoverAnimation:false,data:[{value:0,name:''}]},{name:'年龄结构',type:'pie',radius:['66%','82%'],color:new echarts.graphic.LinearGradient(0,0,0,1,[{offset:0,color:'rgba(25, 193, 213, 1)'},{offset:0.8,color:'rgba(9, 113, 184, 1)'}],false),hoverAnimation:false,label:{normal:{show:false}},labelLine:{normal:{show:false}},data:[{value:6,name:''}]}]};myChart1.setOption(option1);myChart2.setOption(option2);myChart3.setOption(option3)}function getZheCharts(){var outdata={"message":"ok","success":[{"timestamp":1517016060,"value":35041.333333333336},{"timestamp":1517016120,"value":39392.26666666667},{"timestamp":1517016180,"value":33010.666666666664},{"timestamp":1517016240,"value":31314.4},{"timestamp":1517016300,"value":32923.066666666666},{"timestamp":1517016360,"value":32063.866666666665},{"timestamp":1517016420,"value":31240.4},{"timestamp":1517016480,"value":48407.2131147541},{"timestamp":1517016540,"value":74823.18644067796},{"timestamp":1517016600,"value":63034.62295081967},{"timestamp":1517016660,"value":93481.35593220338},{"timestamp":1517016720,"value":98648},{"timestamp":1517016780,"value":100921.86666666667},{"timestamp":1517016840,"value":104927.6},{"timestamp":1517016900,"value":99516.93333333333},{"timestamp":1517016960,"value":95548.85245901639},{"timestamp":1517017020,"value":96937.22033898305},{"timestamp":1517017080,"value":154962.4},{"timestamp":1517017140,"value":174136.93333333332},{"timestamp":1517017200,"value":95632.4},{"timestamp":1517017260,"value":74501.5081967213},{"timestamp":1517017320,"value":62553.49152542373},{"timestamp":1517017380,"value":58904.65573770492},{"timestamp":1517017440,"value":75167.72881355933},{"timestamp":1517017500,"value":109800.93333333333},{"timestamp":1517017560,"value":82637.2},{"timestamp":1517017620,"value":101033.86666666667},{"timestamp":1517017680,"value":70686.26666666666},{"timestamp":1517017740,"value":74554.4918032787},{"timestamp":1517017800,"value":64516.06779661017},{"timestamp":1517017860,"value":69303.46666666666},{"timestamp":1517017920,"value":46118.8},{"timestamp":1517017980,"value":41230.26666666667},{"timestamp":1517018040,"value":42839.333333333336},{"timestamp":1517018100,"value":47631.333333333336},{"timestamp":1517018160,"value":45590.8},{"timestamp":1517018220,"value":45521.066666666666},{"timestamp":1517018280,"value":56872.53333333333},{"timestamp":1517018340,"value":39219.016393442624},{"timestamp":1517018400,"value":43054.23728813559},{"timestamp":1517018460,"value":99025.31147540984},{"timestamp":1517018520,"value":81179.25423728813},{"timestamp":1517018580,"value":52319.86666666667},{"timestamp":1517018640,"value":39759.86666666667},{"timestamp":1517018700,"value":38668.59016393442},{"timestamp":1517018760,"value":40913.35593220339},{"timestamp":1517018820,"value":39351.86885245902},{"timestamp":1517018880,"value":40835.254237288136},{"timestamp":1517018940,"value":51615.6},{"timestamp":1517019000,"value":37292},{"timestamp":1517019060,"value":36175.46666666667},{"timestamp":1517019120,"value":38138.8},{"timestamp":1517019180,"value":227469.46666666667},{"timestamp":1517019240,"value":79293.06666666667},{"timestamp":1517019300,"value":48793.6},{"timestamp":1517019360,"value":76607.33333333333},{"timestamp":1517019420,"value":45503.066666666666},{"timestamp":1517019480,"value":36389.6},{"timestamp":1517019540,"value":58298.26666666667},{"timestamp":1517019600,"value":128562.26666666666},{"timestamp":1517019660,"value":65109.6}]};var indata={"message":"ok","success":[{"timestamp":1517016060,"value":28025.333333333332},{"timestamp":1517016120,"value":30987.733333333334},{"timestamp":1517016180,"value":25757.466666666667},{"timestamp":1517016240,"value":23352.266666666666},{"timestamp":1517016300,"value":30286.8},{"timestamp":1517016360,"value":24909.333333333332},{"timestamp":1517016420,"value":23910.933333333334},{"timestamp":1517016480,"value":29733.245901639344},{"timestamp":1517016540,"value":36796.20338983051},{"timestamp":1517016600,"value":28541.508196721312},{"timestamp":1517016660,"value":34785.76271186441},{"timestamp":1517016720,"value":40354.53333333333},{"timestamp":1517016780,"value":39972.666666666664},{"timestamp":1517016840,"value":43770.26666666667},{"timestamp":1517016900,"value":44413.46666666667},{"timestamp":1517016960,"value":39439.60655737705},{"timestamp":1517017020,"value":40133.69491525424},{"timestamp":1517017080,"value":81990.66666666667},{"timestamp":1517017140,"value":72104.13333333333},{"timestamp":1517017200,"value":669310.9333333333},{"timestamp":1517017260,"value":44831.86885245902},{"timestamp":1517017320,"value":39779.93220338983},{"timestamp":1517017380,"value":41849.18032786885},{"timestamp":1517017440,"value":43096.67796610169},{"timestamp":1517017500,"value":79802.13333333333},{"timestamp":1517017560,"value":36095.2},{"timestamp":1517017620,"value":44548.53333333333},{"timestamp":1517017680,"value":38050.26666666667},{"timestamp":1517017740,"value":41882.49180327869},{"timestamp":1517017800,"value":35034.983050847455},{"timestamp":1517017860,"value":36415.46666666667},{"timestamp":1517017920,"value":46584.8},{"timestamp":1517017980,"value":32100.533333333333},{"timestamp":1517018040,"value":33036},{"timestamp":1517018100,"value":42819.333333333336},{"timestamp":1517018160,"value":36120.53333333333},{"timestamp":1517018220,"value":33692.13333333333},{"timestamp":1517018280,"value":46548.8},{"timestamp":1517018340,"value":38831.08196721312},{"timestamp":1517018400,"value":30402.033898305086},{"timestamp":1517018460,"value":54555.40983606558},{"timestamp":1517018520,"value":46944},{"timestamp":1517018580,"value":34570.933333333334},{"timestamp":1517018640,"value":37271.2},{"timestamp":1517018700,"value":26495.737704918032},{"timestamp":1517018760,"value":32491.118644067796},{"timestamp":1517018820,"value":26446.950819672133},{"timestamp":1517018880,"value":28330.4406779661},{"timestamp":1517018940,"value":42935.86666666667},{"timestamp":1517019000,"value":33062.666666666664},{"timestamp":1517019060,"value":30956},{"timestamp":1517019120,"value":24869.2},{"timestamp":1517019180,"value":102227.46666666666},{"timestamp":1517019240,"value":57280},{"timestamp":1517019300,"value":36131.2},{"timestamp":1517019360,"value":43602.4},{"timestamp":1517019420,"value":29965.066666666666},{"timestamp":1517019480,"value":31028.533333333333},{"timestamp":1517019540,"value":740431.4666666667},{"timestamp":1517019600,"value":56111.6},{"timestamp":1517019660,"value":44676.53333333333}]};var myChart=echarts.init(document.getElementById("realFluxCharts"));var inDataTime=[];var inDataValue=[];for(var i=0;i<indata.success.length;i+=1){inDataTime.push(formatTime(indata.success[i].timestamp));inDataValue.push(conver(indata.success[i].value))}var outDataTime=[];var outDataValue=[];for(var i=0;i<outdata.success.length;i+=1){outDataTime.push(formatTime(outdata.success[i].timestamp));outDataValue.push(conver(outdata.success[i].value))}option={title:{text:'实时网络流量',right:'4%',top:'10',textStyle:{fontFamily:'zhsrxt',fontSize:52,fontWeight:'500',color:'#fff'}},tooltip:{trigger:'axis',axisPointer:{lineStyle:{color:'#57617B'}}},legend:{left:'3.5%',top:'30',textStyle:{fontSize:24,color:'#fff'},data:['网络上行流量','网络下行流量']},grid:{top:'14%',left:'1%',right:'4%',bottom:'3%',containLabel:true},xAxis:{position:'left',nameLocation:'end',nameTextStyle:{},boundaryGap:false,splitNumber:12,axisLine:{show:true,lineStyle:{color:'#3BE0FB',width:2,type:'solid'}},axisLabel:{show:true,rotate:0,nameLocation:'start',margin:8,color:'#3BE0FB',fontSize:26},axisTick:{show:false},splitLine:{show:false,lineStyle:{color:['#3BE0FB'],width:1,type:'solid'}},splitArea:{show:false},data:inDataTime},yAxis:[{type:'value',name:'',axisLine:{show:true,lineStyle:{color:'#3BE0FB',width:2,type:'solid'}},axisLabel:{show:true,rotate:0,nameLocation:'start',margin:8,color:'#3BE0FB',fontSize:26},axisTick:{show:false},splitLine:{show:true,lineStyle:{color:['rgba(240, 240, 240,.3)'],width:1,type:'dashed'}},splitArea:{show:true,areaStyle:{color:['rgba(21, 71, 98,.6)']}}}],series:[{name:'网络上行流量',type:'line',smooth:true,symbol:'circle',symbolSize:5,showSymbol:false,hoverAnimation:false,lineStyle:{normal:{width:2}},areaStyle:{normal:{color:new echarts.graphic.LinearGradient(0,0,0,1,[{offset:0,color:'rgba(231, 33, 40, 0.7)'},{offset:0.8,color:'rgba(231, 33, 40, 0.1)'}],false),shadowColor:'rgba(0, 0, 0, 0.1)',shadowBlur:10}},itemStyle:{normal:{color:'rgb(231, 33, 40)',borderColor:'rgba(231, 33, 40,0.8)',borderWidth:6}},data:inDataValue},{name:'网络下行流量',type:'line',smooth:true,symbol:'circle',symbolSize:5,showSymbol:false,hoverAnimation:false,lineStyle:{normal:{width:2}},areaStyle:{normal:{color:new echarts.graphic.LinearGradient(0,0,0,1,[{offset:0,color:'rgba(60, 221, 248, 0.7)'},{offset:0.8,color:'rgba(60, 221, 248, 0.1)'}],false),shadowColor:'rgba(0, 0, 0, 0.1)',shadowBlur:10}},itemStyle:{normal:{color:'rgb(60, 221, 248)',borderColor:'rgba(60, 221, 248,0.8)',borderWidth:6}},data:outDataValue}]};myChart.setOption(option)}function formatTime(time){let unixtime=time;let unixTimestamp=new Date(unixtime*1000);var h=unixTimestamp.getHours();h=h<10?('0'+h):h;var minute=unixTimestamp.getMinutes();return h+':'+minute}function conver(limit){var size="";size=(limit/(1024*1024)).toFixed(2);var sizestr=size+"";var len=sizestr.indexOf("\.");var dec=sizestr.substr(len+1,2);if(dec=="00"){return sizestr.substring(0,len)+sizestr.substr(len+3,2)}return sizestr}function getCurrentTime(){var date=new Date();var seperator1="-";var seperator2=":";var month=date.getMonth()+1;var strDate=date.getDate();if(month>=1&&month<=9){month="0"+month}if(strDate>=0&&strDate<=9){strDate="0"+strDate}var currentdate=date.getFullYear()+seperator1+month+seperator1+strDate+" "+date.getHours()+seperator2+date.getMinutes()+seperator2+date.getSeconds();return currentdate}function getNowFormatDate(numValue){var date=new Date();var seperator1="-";var seperator2=":";var minutes=parseInt(numValue);var interTimes=minutes*60*1000;var interTimes=parseInt(interTimes);date=new Date(Date.parse(date)-interTimes);var month=date.getMonth()+1;var strDate=date.getDate();var hour=date.getHours();var minutes=date.getMinutes();if(month>=1&&month<=9){month="0"+month}if(strDate>=0&&strDate<=9){strDate="0"+strDate}if(hour>=0&&hour<=9){hour="0"+hour}if(minutes>=0&&minutes<=9){minutes="0"+minutes}var currentdate=date.getFullYear()+seperator1+month+seperator1+strDate+" "+hour+seperator2+minutes+seperator2+date.getSeconds();return currentdate}function getUnixTime(stdTime){return Math.round(Date.parse(stdTime)/1000)}